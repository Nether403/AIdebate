{
  "meta": {
    "project": "AI Debate Arena",
    "date": "2025-11-19",
    "prepared_by": "Generated by Software Development Manager"
  },
  "product_overview": "AI Debate Arena is a scientifically rigorous platform designed to benchmark Large Language Models (LLMs) through dynamic adversarial debates. It transforms static tests into interactive debates orchestrated by multi-agent systems, enabling measurement of both persuasive appeal and logical rigor in model arguments.",
  "core_goals": [
    "Enable real-time adversarial debates between multiple LLMs using persona-driven arguments.",
    "Implement a dual scoring system combining crowd votes and AI judge evaluations for a comprehensive quality measure.",
    "Provide a transparent leaderboard and performance analytics for LLM evaluation.",
    "Integrate automatic fact-checking to ensure factual accuracy of debate claims.",
    "Create a user-friendly UI/UX with real-time streaming, voting, and prediction market gamification.",
    "Ensure platform security, abuse prevention, and cost monitoring to maintain a healthy ecosystem.",
    "Support scalability and performance optimization for responsive and reliable operations."
  ],
  "key_features": [
    "Multi-Agent Debate System utilizing LangGraph with agents for Pro/Con Debates, Fact-Checking, Judging, Moderation, and Topic Generation.",
    "Unified LLM Provider Integration supporting OpenAI, Google Gemini, xAI Grok, Anthropic Claude, and OpenRouter with streaming and cost tracking.",
    "Core Debate Engine managing debate lifecycle, state persistence, recovery, and transcripts.",
    "Dual Rating System implementing Glicko-2 algorithm for Crowd Elo and AI Quality scores, plus Charismatic Liar Index and controversy detection.",
    "Prediction Market with virtual currency (DebatePoints), dynamic odds, payouts, and Superforecaster badges.",
    "Database schema designed with Neon PostgreSQL and Drizzle ORM covering debates, votes, topics, models, and ratings.",
    "Authentication System with OAuth support and anonymous voting capabilities.",
    "Security measures including rate limiting, session fingerprinting, anomalous voting detection, and spending caps.",
    "Comprehensive frontend components: Debate configuration forms, live debate viewers with streaming and fact-check badges, leaderboards, statistics dashboards, theme toggles, and social sharing.",
    "API endpoints to support debate management, voting, leaderboard rankings, statistics, predictions, topics management, and health checks.",
    "Performance optimizations including code splitting, caching with Redis, and monitoring utilities."
  ],
  "user_flow_summary": [
    "Users access the home page and navigate to configure a new debate by selecting models, topics, and personas.",
    "Once a debate is started, the multi-agent system orchestrates the exchange of arguments in real-time, with streaming updates shown in the debate viewer.",
    "Users can anonymously vote on debate rounds selecting sides and rate validity, or participate in prediction markets betting virtual currency on outcomes.",
    "Fact-check badges appear dynamically as claims are verified by the fact-checker agent integrating external search APIs.",
    "After debate completion, users view final transcripts, judge evaluations, and updated leaderboard rankings reflecting crowd and AI scores.",
    "Users can explore leaderboards by various sorting methods and drill down into model or topic-specific statistics.",
    "Authenticated users have access to dashboards displaying personal statistics, voting history, prediction accuracy, and DebatePoints balances."
  ],
  "validation_criteria": [
    "All major features from multi-agent debates to prediction markets are implemented and integrated.",
    "Platform passes performance metrics targets such as low load times, responsive UI, and high Lighthouse scores.",
    "Rate limiting and abuse prevention mechanisms effectively block suspicious activities.",
    "Dual scoring system consistently generates and updates scores based on crowd votes and AI judge evaluations.",
    "Real-time streaming of debate content functions without errors or undue delay.",
    "Database schema supports all required entities and queries complete within acceptable performance windows.",
    "User authentication and session management correctly handle login states and anonymous interactions.",
    "All API endpoints respond with correct data and enforce validation rules with no security leaks.",
    "UI components comply with accessibility guidelines (WCAG 2.1 AA) and support dark/light themes with persistence.",
    "Platform is deployed with health checks passing and stable operation under expected user load."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 16.0.3",
      "React 19.2.0",
      "Tailwind CSS 4.1.17",
      "PostgreSQL (Neon)",
      "Drizzle ORM 0.44.7",
      "Redis (Upstash)",
      "LangChain/LangGraph",
      "Framer Motion",
      "Recharts",
      "Stack Auth",
      "Zod",
      "OpenAI API",
      "Google Gemini API",
      "xAI Grok API",
      "Anthropic Claude API",
      "OpenRouter API",
      "Tavily Search API"
    ],
    "features": [
      {
        "name": "Multi-Agent Debate System",
        "description": "LangGraph-based orchestration system with Pro/Con Debater, Fact-Checker, Judge, Moderator, and Topic Generator agents for conducting adversarial debates between LLM models",
        "files": [
          "lib/agents/graph.ts",
          "lib/agents/debater.ts",
          "lib/agents/fact-checker.ts",
          "lib/agents/judge.ts",
          "lib/agents/moderator.ts",
          "lib/agents/topic-generator.ts",
          "lib/agents/round-transition.ts"
        ]
      },
      {
        "name": "LLM Provider Integration",
        "description": "Unified client for multiple LLM providers with streaming support, token counting, cost tracking, and retry logic",
        "files": [
          "lib/llm/client.ts",
          "lib/llm/base-provider.ts",
          "lib/llm/streaming.ts",
          "lib/llm/providers/openai.ts",
          "lib/llm/providers/google.ts",
          "lib/llm/providers/anthropic.ts",
          "lib/llm/providers/xai.ts",
          "lib/llm/utils/sanitize.ts"
        ]
      },
      {
        "name": "Debate Engine",
        "description": "Core debate lifecycle management with state persistence, checkpoints, recovery, and transcript management",
        "files": [
          "lib/debate/engine.ts",
          "lib/debate/config.ts",
          "lib/debate/transcript.ts",
          "lib/debate/index.ts"
        ]
      },
      {
        "name": "Dual Rating System",
        "description": "Glicko-2 algorithm implementation for dual scoring (Crowd Elo + AI Quality), Charismatic Liar Index, and controversy detection",
        "files": [
          "lib/rating/engine.ts",
          "lib/rating/glicko2.ts"
        ]
      },
      {
        "name": "Prediction Market",
        "description": "Virtual currency betting system with DebatePoints, dynamic odds calculation, payout system, and Superforecaster badges",
        "files": [
          "lib/prediction/market.ts",
          "components/prediction/BettingInterface.tsx",
          "components/prediction/BettingHistory.tsx",
          "components/prediction/UserStatsCard.tsx"
        ]
      },
      {
        "name": "Database Schema & ORM",
        "description": "Neon PostgreSQL database with Drizzle ORM, including schemas for debates, models, personas, topics, votes, bets, and ratings",
        "files": [
          "lib/db/schema.ts",
          "lib/db/client.ts",
          "lib/db/seed.ts",
          "lib/db/indexes.sql",
          "drizzle.config.ts"
        ]
      },
      {
        "name": "Authentication System",
        "description": "Neon Auth (Stack Auth) integration with session management, OAuth support, and anonymous voting",
        "files": [
          "lib/auth/session.ts",
          "app/handler/[...stack]/page.tsx"
        ]
      },
      {
        "name": "Security & Abuse Prevention",
        "description": "IP-based rate limiting, session fingerprinting, anomalous voting detection, cost monitoring, and spending caps",
        "files": [
          "lib/security/abuse-detection.ts",
          "lib/security/fingerprint.ts",
          "lib/security/cost-monitoring.ts",
          "lib/middleware/rate-limit.ts",
          "lib/middleware/cost-guard.ts",
          "lib/middleware/validation.ts"
        ]
      },
      {
        "name": "Caching System",
        "description": "Upstash Redis integration for caching frequently accessed data and reducing database queries",
        "files": [
          "lib/cache/client.ts",
          "lib/performance/cache-utils.ts"
        ]
      },
      {
        "name": "Performance Optimization",
        "description": "Code splitting, lazy loading, monitoring utilities, and performance tracking",
        "files": [
          "lib/performance/lazy-components.tsx",
          "lib/performance/monitoring.ts",
          "lib/performance/cache-utils.ts"
        ]
      },
      {
        "name": "Debate Configuration Form",
        "description": "UI for creating new debates with model selection, topic selection, persona assignment, and parameter configuration",
        "files": [
          "components/debate/DebateConfigForm.tsx",
          "app/debate/new/page.tsx"
        ]
      },
      {
        "name": "Debate Viewer & Orchestrator",
        "description": "Real-time debate viewing with streaming responses, RCR phase display, fact-check badges, and voting interface",
        "files": [
          "components/debate/DebateOrchestrator.tsx",
          "components/debate/DebateTranscript.tsx",
          "components/debate/VotingInterface.tsx",
          "app/debate/[debateId]/page.tsx"
        ]
      },
      {
        "name": "Leaderboard System",
        "description": "Dual score display (Crowd + AI), multiple sorting options, model detail pages, per-topic performance, and controversy highlighting",
        "files": [
          "components/leaderboard/LeaderboardTable.tsx",
          "components/leaderboard/LeaderboardFilters.tsx",
          "components/leaderboard/LeaderboardStats.tsx",
          "components/leaderboard/ModelStatsCard.tsx",
          "components/leaderboard/TopicPerformanceChart.tsx",
          "components/leaderboard/RecentDebatesTable.tsx",
          "components/leaderboard/ProgressChart.tsx",
          "app/leaderboard/page.tsx",
          "app/leaderboard/[modelId]/page.tsx"
        ]
      },
      {
        "name": "Statistics Dashboard",
        "description": "Aggregate platform metrics, trends, and visualizations for overall platform performance",
        "files": [
          "components/statistics/StatisticsDashboard.tsx",
          "app/statistics/page.tsx"
        ]
      },
      {
        "name": "Topic Management",
        "description": "Topic submission, admin approval workflow, auto-replenishment system, and topic categorization",
        "files": [
          "components/topics/TopicSubmissionForm.tsx",
          "app/topics/submit/page.tsx",
          "app/admin/topics/page.tsx"
        ]
      },
      {
        "name": "User Dashboard",
        "description": "Personal statistics, voting history, prediction accuracy, DebatePoints balance, and Superforecaster badges",
        "files": [
          "app/dashboard/page.tsx"
        ]
      },
      {
        "name": "Social Sharing",
        "description": "Social media share buttons, Open Graph metadata, and debate sharing functionality",
        "files": [
          "components/debate/ShareButtons.tsx"
        ]
      },
      {
        "name": "Probability Visualization",
        "description": "Live probability graphs for prediction market odds and betting trends",
        "files": [
          "components/debate/ProbabilityGraph.tsx"
        ]
      },
      {
        "name": "Theme System",
        "description": "Dark/light mode toggle with system preference detection and persistence",
        "files": [
          "components/layout/ThemeProvider.tsx",
          "components/layout/ThemeToggle.tsx"
        ]
      },
      {
        "name": "UI Component Library",
        "description": "Reusable WCAG 2.1 AA compliant components including Button, Card, Badge, Alert, Tabs, Toast, Skeleton, LoadingSpinner, Navigation, Breadcrumbs, Container, PageTransition",
        "files": [
          "components/layout/Button.tsx",
          "components/layout/Card.tsx",
          "components/layout/Badge.tsx",
          "components/layout/Alert.tsx",
          "components/layout/Tabs.tsx",
          "components/layout/Toast.tsx",
          "components/layout/Skeleton.tsx",
          "components/layout/LoadingSpinner.tsx",
          "components/layout/Navigation.tsx",
          "components/layout/Breadcrumbs.tsx",
          "components/layout/Container.tsx",
          "components/layout/PageTransition.tsx"
        ]
      },
      {
        "name": "API Endpoints",
        "description": "RESTful API routes for debate management, voting, leaderboard, statistics, predictions, topics, and health checks",
        "files": [
          "app/api/debate/run/route.ts",
          "app/api/debate/judge/route.ts",
          "app/api/debate/vote/route.ts",
          "app/api/debates/route.ts",
          "app/api/leaderboard/route.ts",
          "app/api/models/route.ts",
          "app/api/personas/route.ts",
          "app/api/topics/route.ts",
          "app/api/statistics/route.ts",
          "app/api/prediction/bet/route.ts",
          "app/api/prediction/odds/route.ts",
          "app/api/export/debates/route.ts",
          "app/api/export/dataset/route.ts",
          "app/api/health/route.ts",
          "app/api/admin/topics/route.ts"
        ]
      },
      {
        "name": "Home Page",
        "description": "Landing page with project overview, animations, and navigation to key features",
        "files": [
          "app/page.tsx"
        ]
      },
      {
        "name": "Component Showcase",
        "description": "Development page showcasing all UI components with examples and documentation",
        "files": [
          "app/components-showcase/page.tsx"
        ]
      },
      {
        "name": "Error Handling",
        "description": "Global error boundaries and error pages with recovery options",
        "files": [
          "app/error.tsx",
          "app/leaderboard/error.tsx"
        ]
      },
      {
        "name": "Loading States",
        "description": "Loading indicators and skeleton screens for async operations",
        "files": [
          "app/loading.tsx",
          "app/leaderboard/loading.tsx"
        ]
      }
    ]
  }
}
